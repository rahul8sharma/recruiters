-# HANDLE WITH CARE!!!
  This layout affects 100% pages of the site. It is the
  absolute base layout. All layouts eventually inherit from this layout.  Basic
  HTML tags, HEAD, BODY tags, etc are all defined here, and yield blocks are
  provided as hooks to add content.

:ruby
  unless defined? options
    options = {}
  end

  options.reverse_merge!({
    :body_class => ""
  })

  @default_seo = {
    :title => "",
    :description => "The most awesome jobs site in India.",
    :image => "/images/ynl_feed_icon.png"
  }


<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
%html{ :itemscope => true, :itemtype => "http://schema.org/Product" }
  %head
    -# - if !!current_user
    -#   :javascript
    -#     current_user = "#{ current_user.sid }";
    -#   - if current_user.external_user?(:facebook)
    -#     :javascript
    -#       current_user_fbid = "#{ current_user.external_auth(:facebook).uid }";


    -#= render :partial => 'shared/analytics/kiss_metrics'
    = favicon_link_tag
    = render :partial => "shared/meta", :locals => {:seo => @default_seo.merge(@seo || {})}

    = yield :extra_meta
    - if content_for? :canonical_link
      = yield :canonical_link
    - else 
      %link{:rel => :canonical, :href => request.url}

    -# custom_bundle(:stylesheet) do
    = stylesheet_link_tag "sparta/rupee"
    = yield :stylesheets
    <!--[if IE 7]>
    =# stylesheet_link_tag 'fixie7'
    <![endif]-->
    = csrf_meta_tags

    -# - stylesheets = (yield :stylesheets)
    -# - bundle :name => bundler_name(:stylesheet) do
    -#   = stylesheet_link_tag "sparta/rupee"
    -#   = yield :stylesheets
    -#   <!--[if IE 7]>
    -#   = stylesheet_link_tag 'fixie7'
    -#   <![endif]-->

    -#= render :partial => 'shared/analytics'
    = render :partial => 'shared/analytics/google_analytics'

  %body{:class => options[:body_class]}
    = yield :body
    = render :partial => 'shared/social_js'

    -# Should be bundled. Bundling must have been removed during one of the
      merges. We should re-enable it at the earliest.

    - if content_for? :jquery
      = yield :jquery
    - else
      = javascript_include_tag 'lib/jquery-1.4.4'

    - if content_for? :jquery_ui
      = yield :jquery_ui
    - else
      = javascript_include_tag "lib/jquery-ui-1.8.11.custom.min"

    -# Block for javascript libs. Any 3rd party libs being used should be loaded
      here. Bundling was disabled here as some bootstrap libs dont play well
      bundled. We should check this, if bundling doesnt raise errors any longer,
      we should activate bundling here also

    / - bundle :name => bundler_name(:libs) do
    = yield :javascript_libs

    -# Block for page javascript.  Custom page js goes here.

    -# custom_bundle(:page) do
    = yield :javascripts

    -# Block for media that should not be bundled. Some 3rd party libs dont play
      well with bundler. Those go here.

    = yield :dont_bundle

    -#= render :partial => 'shared/analytics'
    -#= render :partial => 'shared/analytics/kiss_metrics_events'
