- scores_step = Rails.application.config.reports[@view_mode]["scores_step"]    
- if @report.report_hash[:factor_scores].present?
  - factor_scores = @report.report_hash[:factor_scores]
  - (0..factor_scores.keys.length-1).step(scores_step) do |step|  
    - step_factor_scores = factor_scores.slice(*factor_scores.keys[step..(step+(scores_step - 1))])
    = render partial: "shared/reports/pdf/report_header.pdf.haml"
    .inner
      .scores.favorable_factors
        .divider1
        .pull-left
          .blue_heading.large-text
            Scores of Traits measured in this Assessment
          .divider1
          .instruction_container
            .box.pull-left
              .box-icon.pull-left
              .box-title.pull-left
                Expected Score Range
              .clr

            .instructions.pull-left
              .instruction1.pull-left
                Favorable Traits
              .instruction2.less_favorable.pull-left
                Less Favorable Traits
              .clr

        .pull-right
          .divider1
          .scale
            .line{:style=>"width:#{(@company_norm_buckets.size-1)*50}px"}
            .marker-container
              - @company_norm_buckets.each do |norm_bucket|
                .marker
                  - if norm_bucket.name.split(" ").size == 1
                    %br/
                  = norm_bucket.name
              .clr
        .clr

        %ul.clearfix.scores_listing.first
          - step_factor_scores.each_with_index do |(factor_name,factor_score),index|
            %li{:id => "#{factor_name}"}
              .lhs-sec.pull-left{:style=>"width:520px;"}
                .hexagon-icon{ class: "#{factor_score[:pass] ? 'favorable' : 'less_favorable'}" }
                -#use ".mid_favorable" or ".less_favorable" or ".favorable" to change the color of hexagon
                .span.first
                  .factor-name
                    = factor_name
              .rhs-sec.pull-left
                .slider{:style=>"width:#{(@company_norm_buckets.size-1)*50}px;"}
                  - marker_width = 50
                  - scale = factor_score[:scale]
                  - norm_bucket_uid = factor_score[:norm_bucket_uid]
                  - from_norm_bucket = @company_norm_buckets.detect{|company_norm_bucket| company_norm_bucket.norm_bucket_ids.include? scale[:from_norm_bucket_uid] }
                  - to_norm_bucket = @company_norm_buckets.detect{|company_norm_bucket| company_norm_bucket.norm_bucket_ids.include? scale[:to_norm_bucket_uid] }
                  - company_norm_bucket = @company_norm_buckets.detect{|company_norm_bucket| company_norm_bucket.norm_bucket_ids.include?(norm_bucket_uid)}
                  - position = (company_norm_bucket.weight - 1) * marker_width
                  - offset = ((from_norm_bucket.weight - 1) * marker_width)
                  - width = (to_norm_bucket.weight - from_norm_bucket.weight) * marker_width
                  - if to_norm_bucket.name == @company_norm_buckets.last.name && width == 34
                    - offset = offset - 34
                  .pointer{ class: "#{factor_score[:pass] ? '' : 'less_favorable'}", style: "left: #{position}px;" }
                    -# Use position1, postion2...5. for pointer position, and also add ".less_favorable" for first two buckets- "low" and "below average"
                    .score-indicater
                      = company_norm_bucket.name
                    .arrow
                  .range{ style: "margin-left: #{offset}px;width: #{width}px;" }
                  -#use offset0..offset4 and with this class use .width0...width4 (.width4 is 100%)
              .clr
              .divider1
              .factor-description
                = factor_score[:description]

              - if @report.report_hash[:enable_factor_consistency]
                .responses
                  %i.icon-align-justify
                  Reliability of Candidate's Responses for this Factor:
                  %span.score
                    = factor_score[:consistency_bucket]
              .divider1
    .page-break      
