#distribution_data_points
  .divider1
  .scores.container
    .title
      Data Points about 360 Degree Scores
    .divider2

    .frame.mrf.gray-bg
      .heading.pull-left
        = competency_name
      .clr
      .divider2

      %table{:class=>"span27 margin-auto", :cellpadding=> "0", :cellspacing=> "0"}
        %tr
          %td
            .span7.right-offset1.first
              .extra-medium-text.line-height2
                Overall Scores

              .panel.bg-white
                .divider1
                .rating_snippet
                  .rating_title.green
                    360&#176; Score
                  .value
                    = competency_score[:score][:points]
                  .clr
                .divider1
                .rating_snippet
                  .rating_title.blue
                    Self Rating
                  .value
                    = competency_score[:average_score_self][:points]
                  .clr
                .divider1
                .rating_snippet
                  .rating_title.brown
                    360&#176; (Including Self)
                  .value
                    = competency_score[:average_score_including_self][:points]
                  .clr
                .divider1
                

              .divider2
              .extra-medium-text.line-height2
                Average rating given by Stakeholders
              .panel.bg-white
                .divider1
                - competency_score[:role_wise_scores].each do |role_name, percentages_data|
                  .rating_snippet
                    .rating_title.blue
                      = role_name.titleize
                    .value
                      = percentages_data[:points]
                    .clr
                  .divider1



            .clr
          %td
            .span17.left-offset1
              .divider2
              .panel.bg-white.legend_ratings
                .span.medium-text
                  Legend Ratings
                .clr
                .divider1
                %ul.clearfix
                  - competency_score[:overall_bucket_wise_percentages].each.with_index do |(bucket_name, percentages_data),index|
                    %li
                      .block.span{:style=>"background: #{@bucket_colors[index]};"}
                      .span
                        = bucket_name
                      .clr
              .divider1
              - sorted_distribution = competency_score[:overall_bucket_wise_percentages] #Hash[competency_score[:overall_bucket_wise_percentages].sort_by{|bucket,percentage_data| percentage_data[:percentage] }]  
              .panel.bg-white.rating_breakdown
                .extra-large-text.text-center 
                  Overall Breakdown of Ratings given by all Stakeholders
                .breakdown_bar_section
                  .breakdown_bar.left-offset2.pull-left
                    - sorted_distribution.each.with_index do |(bucket_name, percentages_data),index|
                      .bar{:style=>"height: #{percentages_data[:percentage]}%; background: #{@bucket_colors[index]};"}
                  %ul.breakdown_rating_list.pull-left
                    - sorted_distribution.each.with_index do |(bucket_name, percentages_data),index|
                      %li
                        .block.span{:style=>"background: #{@bucket_colors[index]};"}
                        .span8
                          #{pluralize(percentages_data[:count], "Stakeholder")} (#{percentages_data[:percentage]}%)
                        .clr
                  .clr

            .clr
      .divider1
      - if @report.report_data[:mrf_stakeholder_level_breakdown_at_competency_level]
        .span27.margin-auto
          %ul.clearfix.breakdown_small
            - competency_score[:role_wise_scores].each do |role_name, role_data|
              - sorted_distribution = role_data[:bucket_wise_percentages] #Hash[role_data[:bucket_wise_percentages].sort_by{|bucket, percentages_data| percentages_data[:percentage] }]  
              %li.span9.pull-left
                .panel.rating_breakdown
                  .medium-text
                    Breakdown of Ratings given by #{role_name.titleize.pluralize}
                  .breakdown_bar_section
                    .breakdown_bar.pull-left
                      - sorted_distribution.each.with_index do |(bucket_name, percentages_data),index|
                        .bar{:style=>"height: #{percentages_data[:percentage]}%; background: #{@bucket_colors[index]};"}
                    %ul.breakdown_rating_list.pull-left
                      - sorted_distribution.each.with_index do |(bucket_name, percentages_data),index|
                        %li
                          .block.span{:style=>"background: #{@bucket_colors[index]};"}
                          .span5
                            #{pluralize(percentages_data[:count], role_name.titleize)} (#{percentages_data[:percentage]}%)
                          .clr

                    .clr 
                .divider1
      - if @report.report_data[:mrf_overall_breakdown_at_trait_level]
        - competency_score[:trait_scores].each do |trait_score|
          = render :partial => "mrf/assessments/reports/competency_report/html/trait_distribution_data_points", locals: { trait_score: trait_score }

