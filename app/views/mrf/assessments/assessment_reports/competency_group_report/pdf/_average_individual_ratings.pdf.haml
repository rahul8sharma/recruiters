= render :partial => "shared/360/group_report_header"
.report_content
  .average_individual_ratings
    .color-info.big-text
      Group Average versus Individual 360&#176 Rating
    .divider1 
    .scores_competencies_graph.descending_order.descending_average_rating
      - @report.report_hash[:competency_individual_scores].each do |competency, competency_scores|
        - group_average = 0  
        - competency_scores.each do |scores|
          - group_average += scores[:score].to_f
        - group_average = group_average.to_f / competency_scores.size.to_f        
        .traits_under_graph
          .graph_container
            .left_sec.pull-left
              .extra-medium-text.bold.first.trait_title.line-height2
                = competency
              %ul
                %li
                  .span5.bold.medium-text.first.trait_title
                    Group Average
                  .stakeholder_rating.pull-left
                    = group_average.round(2)
                  .clr
                - competency_scores.each do |scores|
                  %li
                    .span5.medium-text.first.trait_title
                      = scores[:name]
                    .stakeholder_rating.pull-left
                      = scores[:score]
                    .clr
               
            .right_sec.span13.pull-right
              .classic_competency_graph
                .classic_competency_graph_scale
                  .block.pull-left
                    = @competency_graph_buckets.first.min_val
                  - @competency_graph_buckets[1..@competency_graph_buckets.length-1].each do |competency_graph_bucket|
                    .block.pull-left{:style=>"width: #{510/(@competency_graph_buckets.size-1)}px; text-align: right"} 
                      = competency_graph_bucket.min_val

                  .clr
                 
                .graph
                  - old_min = @competency_graph_buckets.first.min_val
                  - old_max = @competency_graph_buckets.last.max_val
                  - percent_360 = convertToRange(old_min, old_max, 0, 100, group_average.to_f)
                  - percent_360 = percent_360 == 0 ? 5 : percent_360
                  .graph_content
                    .divider1
                    .descending_graph_bar.max{:style => "width: #{percent_360}%; background: #469ada;"}
                    .divider1                    
                    - competency_scores.each do |scores|
                      - if scores[:score]
                        - percent_360 = convertToRange(old_min, old_max, 0, 100, scores[:score].to_f)
                        - percent_360 = percent_360 == 0 ? 5 : percent_360
                      - else
                        - percent_360 = 0
                      .divider1
                      .descending_graph_bar.max{:style => "width: #{percent_360}%; background: #469ada;"}
                      .divider1
            .clr
.page-break