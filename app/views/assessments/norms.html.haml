- content_for :jquery do
  = javascript_include_tag "jquery"
  = javascript_include_tag "jquery_ujs"

.create-test.norms
  .inn.first
    .page-title Tests
  .inn
    = render :partial => "shared/test-flow-sub-nav"
    .divider1
    .extra-medium-text
      %b Please fill the following information.
    .divider1
    .medium-text 
      %b Put Title to a Test
      (For Eg : Sales Manager for online Engine Business Unit)
    = form_for @assessment, :as => :assessment, :url => norms_company_assessment_path(:company_id => params[:company_id], :id => params[:id]), multipart: true, method: :get, html: { class: "creat-test-form" } do |f|
      = f.text_field :name
      .divider1
      .control
        %label 
          Function Area
        %select.span8{name: 'assessment[functional_area_id]', id: 'select_functional_area'}
          - @functional_areas.each do |id,functional_area|
            %option{:value => (functional_area.id), selected: (@assessment.functional_area_id == functional_area.id)}
              = functional_area.name
        .clr
      .control.left-offset1
        %label 
          Industry
        %select.span8{name: 'assessment[industry_id]', id: 'select_industry'}
          - @industries.each do |id,industry|
            %option{:value => (industry.id), selected: (@assessment.industry_id == industry.id)}
              = industry.name
        .clr
      .control.left-offset1
        %label 
          Experience Level
        %select.span4{name: 'assessment[job_experience_id]', id: 'select_job_experience'}
          - @job_experiences.each do |id,job_experience|
            %option{:value => (job_experience.id), selected: (@assessment.job_experience_id == job_experience.id)}
              = job_experience.display_text   
        .clr
      .clr
      .divider2
      %button.pull-right.btn.btn-success
        Modify
      .clr
      .divider1
      
    = form_for @assessment, :as => :assessment, :url => norms_company_assessment_path(:company_id => params[:company_id], :id => params[:id]), multipart: true, method: :put do |f|
      %input{type: 'hidden', name: 'assessment[industry_id]', value: @assessment.industry_id}
      %input{type: 'hidden', name: 'assessment[functional_area_id]', value: @assessment.functional_area_id}
      %input{type: 'hidden', name: 'assessment[job_experience_id]', value: @assessment.job_experience_id}
      .action
        %button.pull-right.btn.btn-info
          Proceed
        .clr
      .factors
        .titles.clearfix
          .span17.first
            Factors
          .pull-right
            .span6
              Qualifying score 
            .span2
              Importances 
        .divider1
        %ul.unstyled.factor-snippet
          - @job_assessment_factor_norms.each_with_index do |assessment_factor_norm,index|
            = render :partial => 'assessment_factor_norm_fields', :locals => { :assessment_factor_norm => assessment_factor_norm, :index => index }
      .divider2
      %button.pull-right.btn.btn-info
        Proceed
      .clr
      .divider1

%script{type: 'text/javascript'} 
  jQuery(document).ready(function($){
  $("input[name='selected_factor']").change(function(){
  if($(this).is(":checked")){
  $("input:not(:checkbox)[index='"+$(this).attr("index")+"']").removeAttr("disabled");
  $("select[index='"+$(this).attr("index")+"']").removeAttr("disabled");
  $("#critical_checkbox_"+$(this).attr("index")).removeAttr("disabled");
  }else{
  $("input:not(:checkbox)[index='"+$(this).attr("index")+"']").attr("disabled",'disabled');
  $("select[index='"+$(this).attr("index")+"']").attr("disabled",'disabled');
  $("#critical_checkbox_"+$(this).attr("index")).attr("disabled",'disabled');
  }
  });
  $("input[name='checkbox_critical']").change(function(){
  if($(this).is(":checked")){
  $("#critical_"+$(this).attr("index")).val("on");
  }else{
  $("#critical_"+$(this).attr("index")).val("off");
  }
  });
  });    
